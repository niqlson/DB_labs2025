# Система пошуку репетиторів - Аналіз ER діаграми

## 1. Вимоги:

### Призначення системи:
Має бути спроєктована база даних для магазину
### Потреби зацікавлених сторін:
- **Покупці**: Пошук бажаних товарів, їх збереження та покупка.
- **Продавець**: Управління наявними товарами, відстеження замовлень

### Дані для зберігання:
- Інформація про наявні товари
- Дані про замовлення - статус, ціна, товар в замовлені ...
- Інформація про наявних користувачів, іх персональні дані та ролі
- Інформація про наявні знижки - ціна знижки, час початку та кінця дії
- Дані про відгуки на товари
- Кошики користувачів - предмети, що входять до них.

### Бізнес-правила:
- При замовленні кількість товару в корзині не має перевищувати наявну кількість товару.
- Рейтинг продукту обчислюється на основі отриманих відгуків від покупців.
- Кожен продукт може мати тільки одну активну знижку.
- Не можна зареєструвати акаунт, якщо в системі існує користувач із такою самою поштою.
- Кожне замовлення повино мати статус та змінюватися залежно від стадії обробки
- При оформлені кожного замовленя бронются певна кількість певного товару

## 2. Список сутностей з атрибутами та пояснення зв'язків

### Сутності:

#### User (Користувач)
- **user_id** (PK): Унікальний ідентифікатор користувача
- **first_name**: Ім'я користувача (до 50 символів, обов'язкове)
- **last_name**: Прізвище користувача (до 50 символів, обов'язкове)
- **email**: Електронна пошта (унікальна, обов'язкова)
- **phone**: Номер телефону (унікальний)
- **role**: Роль користувача (студент або репетитор)
- **registration_date**: Дата реєстрації

#### Student (Студент)
- **student_id** (PK & FK): Унікальний ідентифікатор студента, одночасно посилання на User(user_id)
- **school_grade**: Клас навчання (1-11)
- **city**: Місто проживання

#### Tutor (Репетитор)
- **tutor_id** (PK & FK): Унікальний ідентифікатор репетитора, одночасно посилання на User(user_id)
- **education**: Освіта репетитора (текстовий опис)
- **experience_years**: Досвід роботи в роках (0-70)
- **city**: Місто проживання (і проведення оффлайн занять)
- **rating**: Середній рейтинг (0.00-5.00)

#### Subject (Предмет)
- **subject_id** (PK): Унікальний ідентифікатор предмету
- **name**: Назва предмету (обов'язкова)
- **category**: Категорія предмету

#### Tutor_Subject (Зв'язок репетитора з предметом)
- **tutor_subject_id** (PK): Унікальний ідентифікатор зв'язку
- **tutor_id** (FK): Посилання на репетитора
- **subject_id** (FK): Посилання на предмет
- **price**: Ціна за заняття
- **format_online**: Формат навчання онлайн
- **format_offline**: Формат навчання очно

#### Lesson (Заняття)
- **lesson_id** (PK): Унікальний ідентифікатор заняття
- **student_id** (FK): Посилання на студента
- **tutor_subject_id** (FK): Посилання на комбінацію репетитор-предмет
- **schedule_id** (FK): Посилання на слот розкладу репетитора
- **lesson_date**: Дата заняття
- **start_time**: Час початку
- **duration_minutes**: Тривалість в хвилинах
- **status**: Статус заняття (заплановано/завершено/скасовано)

#### Schedule (Розклад)
- **schedule_id** (PK): Унікальний ідентифікатор запису розкладу
- **tutor_id** (FK): Посилання на репетитора
- **day_of_week**: День тижня (1-7, де 1 = понеділок)
- **start_time**: Час початку доступності
- **end_time**: Час закінчення доступності
- **is_available**: Статус доступності слоту (TRUE/FALSE)

#### Review (Відгук)
- **review_id** (PK): Унікальний ідентифікатор відгуку
- **lesson_id** (FK): Посилання на заняття (унікальне)
- **rating**: Оцінка (0.00-5.00)
- **comment**: Текстовий коментар
- **is_anonymous**: Анонімність відгуку
- **created_date**: Дата створення відгуку

### Пояснення зв'язків:

1. **User → Student/Tutor (1:1 PK=FK)**: Один користувач може мати профіль учня або репетитора. Використовується паттерн "Table per Type" де student_id та tutor_id одночасно є первинними ключами та зовнішніми ключами до User(user_id).
2. **Tutor → Tutor_Subject (1:N)**: Один репетитор може викладати декілька предметів з різними умовами (ціна, формат).
3. **Subject → Tutor_Subject (1:N)**: Один предмет можуть викладати багато репетиторів. Ці два зв'язки (Tutor → Tutor_Subject, Subject → Tutor_Subject) репрезентують зв'язок many-to-many (N:N)
4. **Student → Lesson (1:N)**: Один учень може мати багато занять з різними репетиторами.
5. **Tutor_Subject → Lesson (1:N)**: конкретний предмет у репетитора може мати багато занять з різними учнями.
6. **Lesson → Review (1:1)**: Кожне заняття може мати максимум один відгук, але відгук не є обов'язковим.
7. **Tutor → Schedule (1:N)**: Один викладач може мати декілька записів у розкладі для різних днів тижня та часових слотів.
8. **Schedule → Lesson (1:N)**: Один слот розкладу може бути використаний для декількох занять (в різні дати), але кожне заняття прив'язане до конкретного слоту розкладу. 

## 3. Припущення та обмеження

### Припущення:
1. **Гнучкість ціноутворення**: Репетитор може встановлювати різні ціни для різних предметів
2. **Розклад репетитора**: Репетитор встановлює свій розклад доступності, який використовується для бронювання занять
3. **Формат навчання**: Заняття можуть проводитися як онлайн, так і офлайн
4. **Анонімність відгуків**: Студенти можуть залишати анонімні відгуки
5. **Кількість предметів викладача**: при реєстрації викладач має вказати мінімум 1 предмет, який він викладає 

### Обмеження:
1. **Рейтинг репетитора**: Обмежений діапазоном 0.00-5.00
2. **Досвід роботи**: Максимум 70 років
3. **Клас навчання**: Тільки 1-11 класи
4. **Один відгук на заняття**: Кожне заняття може мати тільки один відгук
5. **Обов'язкові поля**: Email та номер телефону повинні бути унікальними
6. **Статуси занять**: Обмежені трьома варіантами (заплановано/завершено/скасовано)
7. **Зв'язок заняття з розкладом**: Кожне заняття повинно відповідати доступному слоту в розкладі репетитора
8. **Дні тижня**: Обмежені значеннями 1-7 (понеділок-неділя)
9. **Ролі користувача**: Користувач може бути або Student, або Tutor (не обома одночасно) через використання PK=FK підходу