# Пояснення SQL-запитів

## 1. Базова агрегація
- **Загальна кількість користувачів**: підраховує усіх користувачів у таблиці `users`.
- **Середня ціна продуктів**: обчислює середню ціну всіх продуктів у таблиці `products`.
- **Мінімальна та максимальна ціна продуктів**: знаходить найдешевший та найдорожчий товари.
- **Загальна кількість доступних продуктів**: сумує всі одиниці товарів на складі (`available_quantity`).

## 2. Групування даних
- **Кількість користувачів за ролями**: групує користувачів за ролями (`USER`/`ADMIN`) і підраховує їх.
- **Середній рейтинг для кожного продукту**: обчислює середній рейтинг на основі відгуків (`reviews`) для кожного продукту.
- **Загальна вартість замовлень за статусом**: показує сумарну вартість замовлень для кожного статусу (`PENDING`, `CONFIRMED` тощо).
- **Кількість замовлень за типом доставки**: групує замовлення за способом доставки (`COURIER`, `PICKUP`, `POST`) і підраховує їх.

## 3. Фільтрування груп (HAVING)
- **Продукти з середнім рейтингом вище 4.0**: виводить лише товари з високою оцінкою клієнтів.
- **Користувачі з більш ніж одним замовленням**: визначає активних покупців.
- **Типи доставки з середньою вартістю доставки більше 5**: показує лише дорогі типи доставки (можна змінити поріг).

## 4. Запити JOIN
- **INNER JOIN замовлень та користувачів**: об’єднує дані замовлень з інформацією про користувачів.
- **LEFT JOIN продуктів та знижок**: показує всі продукти та їхні активні знижки, якщо вони є.
- **RIGHT JOIN відгуків та користувачів**: показує всіх користувачів та їх відгуки, навіть якщо користувачів немає у таблиці `reviews`.
- **FULL JOIN користувачів та кошиків**: відображає всіх користувачів та всі кошики, навіть якщо деякі користувачі не мають кошика.

## 5. Багатотаблична агрегація
- **Загальна сума витрат кожного користувача**: обчислює, скільки кожен користувач витратив на замовлення.
- **Кількість товарів у кошиках для кожного користувача**: сумує кількість товарів у всіх кошиках користувача.
- **Середній рейтинг продуктів з наявністю**: поєднує інформацію про кількість товарів на складі і середній рейтинг на основі відгуків.

## 6. Підзапити
- **Продукти з ціною вище середньої**: підзапит обчислює середню ціну товарів, і вибираються лише дорогі товари.
- **Користувачі, які зробили замовлення**: вибирає лише тих користувачів, які мали хоча б одне замовлення.
- **Інформація про замовлення з кількістю товарів**: додає стовпець із підрахованою кількістю позицій у замовленні.
- **Продукти з кількістю відгуків**: показує популярність товарів за кількістю відгуків.
- **Користувачі з найбільшими замовленнями**: вибирає користувачів із замовленнями вищими за середню вартість.

## 7. Додаткові аналітичні запити
- **Топ-3 найпопулярніші товари за кількістю у кошиках**: визначає товари, які найчастіше додають у кошики.
- **Статистика замовлень по містах**: аналізує кількість замовлень, середню вартість та загальну виручку по містах.
- **Продукти з активними знижками та їх нова ціна**: виводить товари зі знижкою та обчислює їхню ціну після знижки.
